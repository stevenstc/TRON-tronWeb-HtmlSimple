<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Simple GPX coneccion</title>

</head>
<body>

	<button onclick="verDireccion()">Tu direcci√≥n</button> <input type="text" id="address" name="direccion" /><br /><br />
	<button onclick="verBalance()">Tu balance</button> <input type="number" id="balance" name="saldo" /> TRX<br /><br />
	<button onclick="verBalanceGPX()">Tu balance</button> <input type="number" id="balanceGPX" name="saldo" /> GPX<br /><br />
	<br /><br />
	<h1>envios</h1>
	Wallet: <input type="text" id="destino" name="wallet" /><br /><br />
	<button onclick="enviartrx()">Enviar</button> <input type="number" id="trx" name="trx" /> TRX
	<button onclick="enviartrx()">Enviar</button> <input type="number" id="gpx" name="trx" /> GPX

	<br /><br />
	<h1>Registro</h1>
	ID: <input type="text" id="destino" name="wallet" /><br /><br />
	<button onclick="enviartrx()">Enviar</button> <input type="number" id="trx" name="trx" /> TRX
	<button onclick="enviartrx()">Enviar</button> <input type="number" id="gpx" name="trx" /> GPX

	<br /><br />
	<h1>Deposito</h1>
	ID: <input type="text" id="destino" name="wallet" /><br /><br />
	<input type="number" id="meses" name="trx" /> meses
	<button onclick="enviartrx()">cantidad</button> <input type="number" id="gpx2" name="trx" /> GPX


</body>

<script type="text/javascript">

		function verDireccion(){

			var direccion = window.tronWeb.trx.getAccount();

			direccion.then(function(result) {
			  console.log(result);

			  document.getElementById('address').value = window.tronWeb.address.fromHex(result.address);

			});

		}

		function verBalance(){

			var direccion = window.tronWeb.trx.getAccount();

			direccion.then(function(result) {
			  console.log(result);

			  document.getElementById('balance').value = result.balance/1000000;

			});


    }

    async function verBalanceGPX(){

    	var contract = await window.tronWeb.contract().at("TF1aXPN5kZwPsaFjrFPD7jBKPpAzXYdR8S");

    	var user = await window.tronWeb.trx.getAccount();

    	address = await window.tronWeb.address.fromHex(user.address);
    	console.log(address);

			var balance = await contract.balanceOf(address).call();

			balance = parseInt(balance);
			
			document.getElementById('balanceGPX').value = balance/100000000;

		

    }

		async function enviartrx(){


			var contract = await window.tronWeb.contract().at("TF1aXPN5kZwPsaFjrFPD7jBKPpAzXYdR8S");

			console.log(contract);

			var destino = document.getElementById('destino').value;

			var trx = document.getElementById('trx').value;

			trx = parseInt(trx*100000000);

	
			var envio = contract.transfer(destino, trx).send();

			envio.then(function(result) {
			  console.log(result);

				if (result.result) {
					alert("tranferencia exitosa");
				}else{
					alert("tranferencia fallida");
				}


			});

    }



	</script>



	<script type="text/javascript">
      function load() {

        if (window.tronWeb) {
        	console.log("Conectado  Correctamente!");
					alert("Tronlink Conectado Correctamente!");
        }else{
        	console.log("Algo salio mal con Tronlink revisa los archivos");
					alert("La pagina debe estar en un servidor web para conectar");
        }
      }
      window.onload = load;
    </script>
</html>